(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73557ce8"],{"07e0":function(t,e,n){"use strict";n("3867")},"0be6":function(t,e,n){},"159b":function(t,e,n){var a=n("da84"),i=n("fdbc"),r=n("785a"),s=n("17c2"),c=n("9112"),o=function(t){if(t&&t.forEach!==s)try{c(t,"forEach",s)}catch(e){t.forEach=s}};for(var l in i)i[l]&&o(a[l]&&a[l].prototype);o(r)},"17c2":function(t,e,n){"use strict";var a=n("b727").forEach,i=n("a640"),r=i("forEach");t.exports=r?[].forEach:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}},"233d":function(t,e,n){},3867:function(t,e,n){},"408a":function(t,e,n){var a=n("e330");t.exports=a(1..valueOf)},"4f24":function(t,e,n){"use strict";n("233d")},5530:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n("b64b"),n("a4d3"),n("4de4"),n("d3b7"),n("e439"),n("159b"),n("dbb4");function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var a=n("e330"),i=n("1d80"),r=n("577e"),s=n("5899"),c=a("".replace),o="["+s+"]",l=RegExp("^"+o+o+"*"),u=RegExp(o+o+"*$"),f=function(t){return function(e){var n=r(i(e));return 1&t&&(n=c(n,l,"")),2&t&&(n=c(n,u,"")),n}};t.exports={start:f(1),end:f(2),trim:f(3)}},"7abe":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home-container"},[n("van-nav-bar",{staticClass:"page-nav-bar",attrs:{fixed:""}},[n("van-button",{staticClass:"search-btn",attrs:{slot:"title",type:"info",size:"small",round:"",icon:"search",to:"/search"},slot:"title"},[t._v("搜索")])],1),n("van-tabs",{staticClass:"channel-tabs",attrs:{animated:"",swipeable:""},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[t._l(t.channels,(function(t){return n("van-tab",{key:t.id,attrs:{title:t.name}},[n("ArticleList",{attrs:{channel:t}})],1)})),n("div",{staticClass:"placeholder",attrs:{slot:"nav-right"},slot:"nav-right"}),n("div",{staticClass:"hamburger-btn",attrs:{slot:"nav-right"},on:{click:function(e){t.isChennelEditShow=!0}},slot:"nav-right"},[n("i",{staticClass:"iconfont icon-gengduo"})])],2),n("van-popup",{style:{height:"100%"},attrs:{closeable:"",position:"bottom","close-icon-position":"top-left"},model:{value:t.isChennelEditShow,callback:function(e){t.isChennelEditShow=e},expression:"isChennelEditShow"}},[n("ChannelEdit",{attrs:{channels:t.channels,active:t.active},on:{"update-active":t.onUpdateActive}})],1)],1)},i=[],r=n("5530"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-list"},[n("van-pull-refresh",{attrs:{"success-text":t.refreshSuccessText,"success-duration":"1000"},on:{refresh:t.onRefresh},model:{value:t.isreFreshLoading,callback:function(e){t.isreFreshLoading=e},expression:"isreFreshLoading"}},[n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{load:t.onLoad,"update:error":function(e){t.error=e}},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(t,e){return n("ArticleItem",{key:e,attrs:{article:t}})})),1)],1)],1)},c=[],o=n("2909"),l=(n("99af"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-cell",{staticClass:"article-item",attrs:{to:"/article/"+t.article.art_id}},[n("div",{staticClass:"title van-multi-ellipsis--l2",attrs:{slot:"title"},slot:"title"},[t._v(" "+t._s(t.article.title)+" ")]),n("div",{attrs:{slot:"label"},slot:"label"},[3===t.article.cover.type?n("div",{staticClass:"cover-wrap"},t._l(t.article.cover.images,(function(t,e){return n("div",{key:e,staticClass:"cover-item"},[n("van-image",{staticClass:"cover-item-img",attrs:{fit:"cover",src:t}})],1)})),0):t._e(),n("div",{staticClass:"lable-info-wrap"},[n("span",[t._v(t._s(t.article.aut_name))]),n("span",[t._v(t._s(t.article.comm_count)+"评论")]),n("span",[t._v(t._s(t._f("relativeTime")(t.article.pubdate)))])])]),1===t.article.cover.type?n("van-image",{staticClass:"right-cover",attrs:{slot:"default",fit:"cover",src:t.article.cover.images[0]},slot:"default"}):t._e()],1)}),u=[],f=n("5a0c"),d=n.n(f),h={name:"ArticleItem",components:{},props:{article:{type:Object,required:!0}},data:function(){return{}},filters:{relativeTime:function(t){return d()().to(d()(t))}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){}},v=h,p=(n("8b12"),n("2877")),b=Object(p["a"])(v,l,u,!1,null,"84774b40",null),m=b.exports,g={name:"ArticleList",components:{ArticleItem:m},props:{channel:{type:Object,require:!0}},data:function(){return{list:[],loading:!1,finished:!1,timestamp:null,error:!1,isreFreshLoading:!1,refreshSuccessText:"刷新成功"}},computed:{},watch:{},methods:{onLoad:function(){var t=this;this.axios.get("/v1_0/articles?channel_id=".concat(this.channel.id,"&timestamp=").concat(this.timestamp||Date.now())).then((function(e){var n;(n=t.list).push.apply(n,Object(o["a"])(e.data.data.results)),t.loading=!1,e.data.data.results.length?t.timestamp=e.data.data.pre_timestamp:t.finished=!0})).catch((function(e){console.error(e),t.error=!0,t.loading=!1}))},onRefresh:function(){var t=this;this.axios.get("/v1_0/articles?channel_id=".concat(this.channel.id,"&timestamp=").concat(Date.now())).then((function(e){var n;(n=t.list).unshift.apply(n,Object(o["a"])(e.data.data.results)),t.isreFreshLoading=!1,t.refreshSuccessText="刷新成功,更新了".concat(e.data.data.results.length,"条数据")})).catch((function(e){t.isreFreshLoading=!1,t.refreshSuccessText="刷新失败"}))}},created:function(){},mounted:function(){}},_=g,y=(n("4f24"),Object(p["a"])(_,s,c,!1,null,"a8d9b4a8",null)),C=y.exports,E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"channel-edit"},[n("van-cell",{attrs:{border:!1}},[n("div",{staticClass:"title-text",attrs:{slot:"title"},slot:"title"},[t._v("我的频道")]),n("van-button",{staticClass:"edit-btn",attrs:{type:"danger",plain:"",round:"",size:"mini"},on:{click:function(e){t.isEdit=!t.isEdit}}},[t._v(t._s(t.isEdit?"完成":"编辑"))])],1),n("van-grid",{staticClass:"my-grid",attrs:{gutter:10}},t._l(t.channels,(function(e,a){return n("van-grid-item",{key:e.id,staticClass:"grid-item",on:{click:function(n){return t.onMyChannelClick(e,a)}}},[n("van-icon",{directives:[{name:"show",rawName:"v-show",value:t.isEdit&&0!==e.id,expression:"isEdit && item.id !== 0"}],attrs:{slot:"icon",name:"clear"},slot:"icon"}),n("span",{staticClass:"text",class:{active:a===t.active},attrs:{slot:"text"},slot:"text"},[t._v(t._s(e.name))])],1)})),1),n("van-cell",{attrs:{border:!1}},[n("div",{staticClass:"title-text",attrs:{slot:"title"},slot:"title"},[t._v("频道推荐")])]),n("van-grid",{staticClass:"recommend-grid",attrs:{gutter:10}},t._l(t.recommendChannels,(function(e){return n("van-grid-item",{key:e.id,staticClass:"grid-item",attrs:{icon:"plus",text:e.name},on:{click:function(n){return t.onAddChannel(e)}}})})),1)],1)},O=[],x=(n("a9e3"),n("d3b7"),n("159b"),n("7db0"),n("e9c4"),n("a434"),n("2f62")),w={name:"ChannelEdit",components:{},props:{channels:{type:Array,required:!0},active:{type:Number,required:!0}},data:function(){return{allChannels:[],isEdit:!1}},computed:Object(r["a"])(Object(r["a"])({},Object(x["b"])(["user"])),{},{recommendChannels:function(){var t=this,e=[];return this.allChannels.forEach((function(n){var a=t.channels.find((function(t){return t.id===n.id}));a||e.push(n)})),e}}),watch:{},methods:{onAddChannel:function(t){var e=this;this.channels.push(t),this.user?this.axios.patch("/v1_0/user/channels",{channels:[{id:t.id,seq:this.channels.length}]}).then((function(t){})).catch((function(t){e.$toast("操作失败，请稍后重试")})):localStorage.setItem("TOUTIAO_CHANNELS",JSON.stringify(this.channels))},onMyChannelClick:function(t,e){var n=this;this.isEdit&&0!==e?(e<=this.active&&this.$emit("update-active",this.active-1,!0),this.channels.splice(e,1),this.user?this.axios.delete("/v1_0/user/channels/".concat(t.id)).then((function(t){})).catch((function(t){n.$toast("操作失败，请稍后重试")})):localStorage.setItem("TOUTIAO_CHANNELS",JSON.stringify(this.channels))):this.isEdit||this.$emit("update-active",e,!1)}},created:function(){var t=this;this.axios.get("/v1_0/channels").then((function(e){t.allChannels=e.data.data.channels})).catch((function(e){t.$toast("数据获取失败")}))},mounted:function(){}},N=w,j=(n("07e0"),Object(p["a"])(N,E,O,!1,null,"e91ea1f4",null)),A=j.exports,I={name:"HomeIndex",components:{ArticleList:C,ChannelEdit:A},props:{},data:function(){return{active:0,channels:[],isChennelEditShow:!1}},computed:Object(r["a"])({},Object(x["b"])(["user"])),watch:{},methods:{onUpdateActive:function(t,e){this.active=t,this.isChennelEditShow=e}},created:function(){var t=this,e=[];if(this.user)this.axios.get("/v1_0/user/channels").then((function(n){e=n.data.data.channels,t.channels=e})).catch((function(t){console.error(t)}));else{var n=JSON.parse(localStorage.getItem("TOUTIAO_CHANNELS"));n?this.channels=n:this.axios.get("/v1_0/user/channels").then((function(n){e=n.data.data.channels,t.channels=e})).catch((function(t){console.error(t)}))}},mounted:function(){}},S=I,k=(n("b56c"),Object(p["a"])(S,a,i,!1,null,"b70d843e",null));e["default"]=k.exports},"7db0":function(t,e,n){"use strict";var a=n("23e7"),i=n("b727").find,r=n("44d2"),s="find",c=!0;s in[]&&Array(1)[s]((function(){c=!1})),a({target:"Array",proto:!0,forced:c},{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(s)},"8b12":function(t,e,n){"use strict";n("eb3d")},a434:function(t,e,n){"use strict";var a=n("23e7"),i=n("da84"),r=n("23cb"),s=n("5926"),c=n("07fa"),o=n("7b0b"),l=n("65f0"),u=n("8418"),f=n("1dde"),d=f("splice"),h=i.TypeError,v=Math.max,p=Math.min,b=9007199254740991,m="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!d},{splice:function(t,e){var n,a,i,f,d,g,_=o(this),y=c(_),C=r(t,y),E=arguments.length;if(0===E?n=a=0:1===E?(n=0,a=y-C):(n=E-2,a=p(v(s(e),0),y-C)),y+n-a>b)throw h(m);for(i=l(_,a),f=0;f<a;f++)d=C+f,d in _&&u(i,f,_[d]);if(i.length=a,n<a){for(f=C;f<y-a;f++)d=f+a,g=f+n,d in _?_[g]=_[d]:delete _[g];for(f=y;f>y-a+n;f--)delete _[f-1]}else if(n>a)for(f=y-a;f>C;f--)d=f+a-1,g=f+n-1,d in _?_[g]=_[d]:delete _[g];for(f=0;f<n;f++)_[f+C]=arguments[f+2];return _.length=y-a+n,i}})},a640:function(t,e,n){"use strict";var a=n("d039");t.exports=function(t,e){var n=[][t];return!!n&&a((function(){n.call(null,e||function(){throw 1},1)}))}},a9e3:function(t,e,n){"use strict";var a=n("83ab"),i=n("da84"),r=n("e330"),s=n("94ca"),c=n("6eeb"),o=n("1a2d"),l=n("7156"),u=n("3a9b"),f=n("d9b5"),d=n("c04e"),h=n("d039"),v=n("241c").f,p=n("06cf").f,b=n("9bf2").f,m=n("408a"),g=n("58a8").trim,_="Number",y=i[_],C=y.prototype,E=i.TypeError,O=r("".slice),x=r("".charCodeAt),w=function(t){var e=d(t,"number");return"bigint"==typeof e?e:N(e)},N=function(t){var e,n,a,i,r,s,c,o,l=d(t,"number");if(f(l))throw E("Cannot convert a Symbol value to a number");if("string"==typeof l&&l.length>2)if(l=g(l),e=x(l,0),43===e||45===e){if(n=x(l,2),88===n||120===n)return NaN}else if(48===e){switch(x(l,1)){case 66:case 98:a=2,i=49;break;case 79:case 111:a=8,i=55;break;default:return+l}for(r=O(l,2),s=r.length,c=0;c<s;c++)if(o=x(r,c),o<48||o>i)return NaN;return parseInt(r,a)}return+l};if(s(_,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var j,A=function(t){var e=arguments.length<1?0:y(w(t)),n=this;return u(C,n)&&h((function(){m(n)}))?l(Object(e),n,A):e},I=a?v(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),S=0;I.length>S;S++)o(y,j=I[S])&&!o(A,j)&&b(A,j,p(y,j));A.prototype=C,C.constructor=A,c(i,_,A)}},b56c:function(t,e,n){"use strict";n("0be6")},b64b:function(t,e,n){var a=n("23e7"),i=n("7b0b"),r=n("df75"),s=n("d039"),c=s((function(){r(1)}));a({target:"Object",stat:!0,forced:c},{keys:function(t){return r(i(t))}})},dbb4:function(t,e,n){var a=n("23e7"),i=n("83ab"),r=n("56ef"),s=n("fc6a"),c=n("06cf"),o=n("8418");a({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(t){var e,n,a=s(t),i=c.f,l=r(a),u={},f=0;while(l.length>f)n=i(a,e=l[f++]),void 0!==n&&o(u,e,n);return u}})},e439:function(t,e,n){var a=n("23e7"),i=n("d039"),r=n("fc6a"),s=n("06cf").f,c=n("83ab"),o=i((function(){s(1)})),l=!c||o;a({target:"Object",stat:!0,forced:l,sham:!c},{getOwnPropertyDescriptor:function(t,e){return s(r(t),e)}})},eb3d:function(t,e,n){}}]);
//# sourceMappingURL=chunk-73557ce8.a91398ef.js.map